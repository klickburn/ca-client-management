(this["webpackJsonpca-client-management-frontend"]=this["webpackJsonpca-client-management-frontend"]||[]).push([[0],{25:function(e,s,t){},52:function(e,s,t){},58:function(e,s,t){},59:function(e,s,t){},60:function(e,s,t){},61:function(e,s,t){},62:function(e,s,t){},63:function(e,s,t){},64:function(e,s,t){},65:function(e,s,t){},66:function(e,s,t){},67:function(e,s,t){},68:function(e,s,t){},69:function(e,s,t){},70:function(e,s,t){},71:function(e,s,t){"use strict";t.r(s);var a=t(1),c=t.n(a),n=t(26),r=t.n(n),l=t(6),i=t(2),o=t(10),d=t.n(o);const j="http://localhost:5001/api/auth/",m=async(e,s)=>{const t=await d.a.post(j+"login",{username:e,password:s});return t.data.token&&localStorage.setItem("user",JSON.stringify(t.data)),t.data},b=()=>{localStorage.removeItem("user")},u=()=>JSON.parse(localStorage.getItem("user"));var h=t(0);const O=Object(a.createContext)(),x=e=>{let{children:s}=e;const[t,c]=Object(a.useState)(null),[n,r]=Object(a.useState)(!0);Object(a.useEffect)((()=>{(async()=>{try{const e=await u();c(e)}catch(e){console.error("Failed to fetch user:",e),localStorage.removeItem("user"),c(null)}finally{r(!1)}})()}),[]);return Object(h.jsx)(O.Provider,{value:{user:t,loading:n,login:async(e,s)=>{try{const t=await m(e,s);return c(t),t}catch(t){throw console.error("Login failed:",t),t}},logout:async()=>{await b(),c(null)}},children:s})};t(52);var p=()=>{const[e,s]=Object(a.useState)(""),[t,c]=Object(a.useState)(""),[n,r]=Object(a.useState)(""),[l,o]=Object(a.useState)(!1),d=Object(i.g)(),{login:j}=Object(a.useContext)(O);return Object(h.jsx)("div",{className:"login-page",children:Object(h.jsxs)("div",{className:"login-container",children:[Object(h.jsxs)("div",{className:"login-logo",children:[Object(h.jsx)("h1",{children:"CA Client Manager"}),Object(h.jsx)("p",{children:"Manage your CA firm clients efficiently"})]}),Object(h.jsxs)("div",{className:"login-form-container",children:[Object(h.jsx)("h2",{children:"Login"}),n&&Object(h.jsx)("p",{className:"error-message",children:n}),Object(h.jsxs)("form",{onSubmit:async s=>{s.preventDefault(),r(""),o(!0);try{const s=await j(e,t);if(!s||!s.role)throw new Error("Invalid user data returned");d.push("admin"===s.role?"/admin":"/user")}catch(n){r("Invalid username or password"),console.error("Login error:",n)}finally{o(!1)}},className:"login-form",children:[Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"username",children:"Username"}),Object(h.jsx)("input",{type:"text",id:"username",value:e,onChange:e=>s(e.target.value),required:!0})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"password",children:"Password"}),Object(h.jsx)("input",{type:"password",id:"password",value:t,onChange:e=>c(e.target.value),required:!0})]}),Object(h.jsx)("button",{type:"submit",className:"login-button",disabled:l,children:l?"Logging in...":"Login"})]}),Object(h.jsx)("div",{className:"login-footer",children:Object(h.jsx)("p",{children:"\xa9 2025 CA Client Management System"})})]})]})})};const v=d.a.create({baseURL:"http://localhost:5001/api",headers:{"Content-Type":"application/json"}});v.interceptors.request.use((e=>{try{const s=localStorage.getItem("user");if(s){const t=JSON.parse(s);t&&t.token&&(e.headers.Authorization=`Bearer ${t.token}`)}}catch(s){console.error("Error setting auth header:",s)}return e}),(e=>Promise.reject(e))),v.interceptors.response.use((e=>e),(e=>(e.response?401===e.response.status?(localStorage.removeItem("user"),window.location.href="/login"):403===e.response.status?console.error("Permission denied. Please check your access rights."):500===e.response.status&&console.error("Server error:",e.response.data):e.request?console.error("No response received from server:",e.request):console.error("Error setting up request:",e.message),Promise.reject(e))));var N=v;t(58);const g={username:"",password:"",role:"user"};var f=e=>{let{user:s,onSave:t,onCancel:c}=e;const[n,r]=Object(a.useState)(g),[l,i]=Object(a.useState)({}),[o,d]=Object(a.useState)(!1),[j,m]=Object(a.useState)(null),b=!(null===s||void 0===s||!s._id);Object(a.useEffect)((()=>{s&&r({username:s.username||"",password:"",role:s.role||"user"})}),[s]);const u=e=>{const{name:s,value:t}=e.target;r((e=>({...e,[s]:t}))),l[s]&&i((e=>({...e,[s]:null})))};return Object(h.jsxs)("div",{className:"user-form-container",children:[Object(h.jsx)("h2",{children:b?"Edit User":"Create New User"}),j&&Object(h.jsx)("div",{className:"error-message",children:j}),Object(h.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return n.username.trim()?n.username.trim().length<3&&(e.username="Username must be at least 3 characters"):e.username="Username is required",b||n.password.trim()?!b&&n.password.trim().length<6&&(e.password="Password must be at least 6 characters"):e.password="Password is required",i(e),0===Object.keys(e).length})()){d(!0),m(null);try{const e={username:n.username,role:n.role};n.password.trim()&&(e.password=n.password),await t(e,b)}catch(c){var s,a;console.error("Error saving user:",c),m((null===(s=c.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Error saving user. Please try again.")}finally{d(!1)}}},className:"user-form",children:[Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"username",children:"Username"}),Object(h.jsx)("input",{type:"text",id:"username",name:"username",value:n.username,onChange:u,className:l.username?"error":""}),l.username&&Object(h.jsx)("div",{className:"error-text",children:l.username})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"password",children:b?"New Password (leave blank to keep current)":"Password"}),Object(h.jsx)("input",{type:"password",id:"password",name:"password",value:n.password,onChange:u,className:l.password?"error":""}),l.password&&Object(h.jsx)("div",{className:"error-text",children:l.password})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"role",children:"Role"}),Object(h.jsxs)("select",{id:"role",name:"role",value:n.role,onChange:u,children:[Object(h.jsx)("option",{value:"user",children:"User"}),Object(h.jsx)("option",{value:"admin",children:"Admin"})]})]}),Object(h.jsxs)("div",{className:"form-actions",children:[Object(h.jsx)("button",{type:"button",className:"cancel-button",onClick:c,children:"Cancel"}),Object(h.jsx)("button",{type:"submit",className:"save-button",disabled:o,children:o?"Saving...":b?"Update User":"Create User"})]})]})]})};t(59);var w=e=>{let{onSave:s,onCancel:t}=e;const[c,n]=Object(a.useState)(""),[r,l]=Object(a.useState)("");return Object(h.jsxs)("div",{className:"user-create-container",children:[c&&Object(h.jsx)("p",{className:"success-message",children:c}),r&&Object(h.jsx)("p",{className:"error-message",children:r}),Object(h.jsx)(f,{onSave:async e=>{try{const t=await(async e=>(await v.post("/users/create",e)).data)(e);return n("User created successfully"),l(""),s&&s(t),t}catch(c){var t,a;const e=(null===(t=c.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Error creating user";throw l(e),c}},onCancel:t})]})};t(60);var y=()=>{const[e,s]=Object(a.useState)([]),[t,c]=Object(a.useState)([]),[n,r]=Object(a.useState)({totalUsers:0,totalClients:0,activeClients:0}),[l,i]=Object(a.useState)(!1),[o,d]=Object(a.useState)(null),[j,m]=Object(a.useState)(""),[b,u]=Object(a.useState)({userId:null,username:"",hashedPassword:"",isVisible:!1,showPassword:!1}),O=Object(a.useRef)(null);Object(a.useEffect)((()=>{x(),p()}),[]),Object(a.useEffect)((()=>{function e(e){O.current&&!O.current.contains(e.target)&&u((e=>({...e,isVisible:!1})))}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[O]);const x=async()=>{try{const e=await(async()=>(await v.get("/users")).data)();s(e||[]),r((s=>({...s,totalUsers:e?e.length:0})))}catch(e){console.error("Error fetching users:",e),m("Failed to fetch users. Please try again.")}},p=async()=>{try{r({totalUsers:e.length,totalClients:15,activeClients:12})}catch(s){console.error("Error fetching stats:",s)}},N=()=>{i(!1),d(null),x()},g=()=>{i(!1),d(null)},y=async e=>{if(window.confirm("Are you sure you want to delete this user?"))try{await(async e=>(await v.delete(`/users/${e}`)).data)(e),x()}catch(s){console.error("Error deleting user:",s),m("Failed to delete user. Please try again.")}},C=async(e,s)=>{try{if(b.isVisible&&b.userId===e)return void u((e=>({...e,isVisible:!1})));const t=await(async e=>(await v.get(`/users/password/${e}`)).data)(e);u({userId:e,username:t.username||s,hashedPassword:t.hashedPassword||"Password not available",isVisible:!0,showPassword:!1})}catch(t){console.error("Error fetching user password:",t),m("Failed to fetch user password. Please try again.")}};return Object(h.jsxs)("div",{className:"admin-dashboard",children:[Object(h.jsx)("h1",{children:"Admin Dashboard"}),j&&Object(h.jsxs)("div",{className:"error-message",children:[j,Object(h.jsx)("button",{onClick:()=>m(""),className:"dismiss-button",children:"\xd7"})]}),Object(h.jsxs)("div",{className:"stats-cards",children:[Object(h.jsxs)("div",{className:"stat-card",children:[Object(h.jsx)("h3",{children:"Total Users"}),Object(h.jsx)("div",{className:"stat-value",children:n.totalUsers})]}),Object(h.jsxs)("div",{className:"stat-card",children:[Object(h.jsx)("h3",{children:"Total Clients"}),Object(h.jsx)("div",{className:"stat-value",children:n.totalClients})]}),Object(h.jsxs)("div",{className:"stat-card",children:[Object(h.jsx)("h3",{children:"Active Clients"}),Object(h.jsx)("div",{className:"stat-value",children:n.activeClients})]})]}),l?Object(h.jsxs)("div",{className:"card-section",children:[Object(h.jsx)("div",{className:"card-section-header",children:Object(h.jsx)("h2",{children:"Create New User"})}),Object(h.jsx)("div",{className:"card-section-content",children:Object(h.jsx)(w,{onSave:N,onCancel:g})})]}):o?Object(h.jsxs)("div",{className:"card-section",children:[Object(h.jsx)("div",{className:"card-section-header",children:Object(h.jsx)("h2",{children:"Edit User"})}),Object(h.jsx)("div",{className:"card-section-content",children:Object(h.jsx)(f,{user:o,onSave:N,onCancel:g})})]}):Object(h.jsxs)("div",{className:"card-section",children:[Object(h.jsxs)("div",{className:"card-section-header",children:[Object(h.jsx)("h2",{children:"Registered Users"}),Object(h.jsxs)("button",{className:"add-user-button",onClick:()=>{i(!0),d(null)},children:[Object(h.jsx)("i",{className:"fas fa-plus"})," Add User"]})]}),Object(h.jsx)("div",{className:"card-section-content",children:Object(h.jsxs)("table",{className:"user-table",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Username"}),Object(h.jsx)("th",{children:"Role"}),Object(h.jsx)("th",{children:"Actions"})]})}),Object(h.jsx)("tbody",{children:e.length>0?e.map((e=>Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.username}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:`user-role ${e.role}`,children:e.role})}),Object(h.jsxs)("td",{children:[Object(h.jsx)("button",{className:"action-button edit",onClick:()=>(e=>{d(e),i(!1)})(e),children:"Edit"}),Object(h.jsx)("button",{className:"action-button delete",onClick:()=>y(e._id),children:"Delete"}),Object(h.jsx)("button",{className:"action-button view-password",onClick:()=>C(e._id,e.username),children:b.isVisible&&b.userId===e._id?"Hide Password":"View Password"})]})]},e._id))):Object(h.jsx)("tr",{children:Object(h.jsx)("td",{colSpan:"3",style:{textAlign:"center"},children:"No users found"})})})]})})]}),b.isVisible&&Object(h.jsx)("div",{className:"password-modal-overlay",children:Object(h.jsxs)("div",{className:"password-modal",ref:O,children:[Object(h.jsxs)("div",{className:"password-modal-header",children:[Object(h.jsxs)("h3",{children:["Password for ",b.username]}),Object(h.jsx)("button",{className:"dismiss-button",onClick:()=>u((e=>({...e,isVisible:!1}))),children:"\xd7"})]}),Object(h.jsxs)("div",{className:"password-modal-content",children:[Object(h.jsxs)("div",{className:"password-section",children:[Object(h.jsxs)("div",{className:"password-section-header",children:[Object(h.jsx)("p",{children:"Hashed Password:"}),Object(h.jsxs)("button",{className:"toggle-password-visibility",onClick:()=>{u((e=>({...e,showPassword:!e.showPassword})))},children:[b.showPassword?"Hide":"Show"," Password"]})]}),Object(h.jsx)("div",{className:"password-display",children:b.showPassword?b.hashedPassword:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]}),Object(h.jsxs)("p",{className:"password-note",children:[Object(h.jsx)("i",{className:"fas fa-info-circle"})," This is a hashed password. For security reasons, the actual password cannot be retrieved."]})]})]})})]})};var C={getClients:async()=>{try{return(await N.get("/clients")).data}catch(e){throw console.error("Error fetching clients:",e.response||e),e}},getClient:async e=>{try{return(await N.get(`/clients/${e}`)).data}catch(s){throw console.error("Error fetching client details:",s.response||s),s}},createClient:async e=>{try{return(await N.post("/clients",e)).data}catch(s){throw console.error("Error creating client:",s.response||s),s}},updateClient:async(e,s)=>{try{return(await N.put(`/clients/${e}`,s)).data}catch(t){throw console.error("Error updating client:",t.response||t),t}},deleteClient:async e=>{try{return(await N.delete(`/clients/${e}`)).data}catch(s){throw console.error("Error deleting client:",s.response||s),s}}};t(61);var S=e=>{let{onClientSelect:s,onCreateClient:t}=e;const[c,n]=Object(a.useState)([]),[r,l]=Object(a.useState)(!0),[i,o]=Object(a.useState)(""),[d,j]=Object(a.useState)(null);Object(a.useEffect)((()=>{m()}),[]);const m=async()=>{try{l(!0);const e=await C.getClients();n(e),j(null)}catch(e){j("Error fetching clients. Please try again later."),console.error("Error fetching clients:",e)}finally{l(!1)}},b=c.filter((e=>e.name.toLowerCase().includes(i.toLowerCase())||e.email.toLowerCase().includes(i.toLowerCase())||e.phone.includes(i)||e.panNumber&&e.panNumber.toLowerCase().includes(i.toLowerCase())||e.gstNumber&&e.gstNumber.toLowerCase().includes(i.toLowerCase())));return Object(h.jsxs)("div",{className:"client-list-container",children:[Object(h.jsxs)("div",{className:"client-list-header",children:[Object(h.jsx)("h2",{children:"Clients"}),Object(h.jsx)("button",{className:"create-client-button",onClick:t,children:"Add New Client"})]}),Object(h.jsx)("div",{className:"client-search",children:Object(h.jsx)("input",{type:"text",placeholder:"Search clients by name, email, phone, PAN, or GST...",value:i,onChange:e=>o(e.target.value)})}),d&&Object(h.jsx)("div",{className:"error-message",children:d}),r?Object(h.jsx)("div",{className:"loading-spinner",children:"Loading clients..."}):Object(h.jsx)(h.Fragment,{children:0===b.length?Object(h.jsx)("p",{className:"no-clients-message",children:i?"No clients found matching your search.":'No clients found. Click "Add New Client" to create one.'}):Object(h.jsx)("div",{className:"client-grid",children:b.map((e=>Object(h.jsxs)("div",{className:"client-card",children:[Object(h.jsx)("div",{className:"client-name",children:e.name}),Object(h.jsx)("div",{className:"client-type",children:e.clientType}),Object(h.jsxs)("div",{className:"client-details",children:[Object(h.jsxs)("div",{className:"client-detail",children:["\ud83d\udce7 ",e.email]}),Object(h.jsxs)("div",{className:"client-detail",children:["\ud83d\udcde ",e.phone]}),e.panNumber&&Object(h.jsxs)("div",{className:"client-detail",children:["\ud83e\udeaa PAN: ",e.panNumber]}),e.gstNumber&&Object(h.jsxs)("div",{className:"client-detail",children:["\ud83d\udcdd GST: ",e.gstNumber]})]}),Object(h.jsxs)("div",{className:"client-actions",children:[Object(h.jsx)("button",{className:"action-button view-button",onClick:()=>s(e),children:"View Details"}),Object(h.jsx)("button",{className:"action-button delete-button",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this client?"))try{await C.deleteClient(e),n(c.filter((s=>s._id!==e)))}catch(s){j("Error deleting client. Please try again."),console.error("Error deleting client:",s)}})(e._id),children:"Delete"})]})]},e._id)))})})]})};t(62);const E={name:"",email:"",phone:"",address:"",panNumber:"",gstNumber:"",clientType:"Individual",services:[],notes:""},P=["Income Tax Filing","GST Filing","Accounting","Audit","Company Formation","Consultancy","Other"],A=["Individual","Partnership","LLP","Pvt Ltd","Public Ltd","HUF","Other"];var k=e=>{let{client:s,onSave:t,onCancel:c}=e;const[n,r]=Object(a.useState)(E),[l,i]=Object(a.useState)({}),[o,d]=Object(a.useState)(!1),[j,m]=Object(a.useState)(null),b=!(null===s||void 0===s||!s._id);Object(a.useEffect)((()=>{s&&r({name:s.name||"",email:s.email||"",phone:s.phone||"",address:s.address||"",panNumber:s.panNumber||"",gstNumber:s.gstNumber||"",clientType:s.clientType||"Individual",services:s.services||[],notes:s.notes||""})}),[s]);const u=e=>{const{name:s,value:t}=e.target;r((e=>({...e,[s]:t}))),l[s]&&i((e=>({...e,[s]:null})))};return Object(h.jsxs)("div",{className:"client-form-container",children:[Object(h.jsx)("h2",{children:b?"Edit Client":"Create New Client"}),j&&Object(h.jsx)("div",{className:"error-message",children:j}),Object(h.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return n.name.trim()||(e.name="Name is required"),n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(e.email="Email is invalid"):e.email="Email is required",n.phone.trim()?/^[0-9+\s()-]{10,15}$/.test(n.phone.replace(/\s/g,""))||(e.phone="Phone number is invalid"):e.phone="Phone number is required",n.address.trim()||(e.address="Address is required"),n.panNumber&&!/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/.test(n.panNumber)&&(e.panNumber="PAN number should be in valid format (e.g., ABCDE1234F)"),n.gstNumber&&!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[0-9A-Z]{1}[Z]{1}[0-9A-Z]{1}$/.test(n.gstNumber)&&(e.gstNumber="GST number should be in valid format (e.g., 22AAAAA0000A1Z5)"),i(e),0===Object.keys(e).length})()){d(!0),m(null);try{let e;e=b?await C.updateClient(s._id,n):await C.createClient(n),t(e)}catch(r){var a,c;console.error("Error saving client:",r),m((null===(a=r.response)||void 0===a||null===(c=a.data)||void 0===c?void 0:c.message)||"Error saving client. Please try again.")}finally{d(!1)}}},className:"client-form",children:[Object(h.jsxs)("div",{className:"form-section",children:[Object(h.jsx)("h3",{children:"Basic Information"}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"name",children:"Client Name *"}),Object(h.jsx)("input",{type:"text",id:"name",name:"name",value:n.name,onChange:u,className:l.name?"error":""}),l.name&&Object(h.jsx)("div",{className:"error-text",children:l.name})]}),Object(h.jsxs)("div",{className:"form-row",children:[Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"email",children:"Email *"}),Object(h.jsx)("input",{type:"email",id:"email",name:"email",value:n.email,onChange:u,className:l.email?"error":""}),l.email&&Object(h.jsx)("div",{className:"error-text",children:l.email})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"phone",children:"Phone *"}),Object(h.jsx)("input",{type:"text",id:"phone",name:"phone",value:n.phone,onChange:u,className:l.phone?"error":""}),l.phone&&Object(h.jsx)("div",{className:"error-text",children:l.phone})]})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"address",children:"Address *"}),Object(h.jsx)("textarea",{id:"address",name:"address",value:n.address,onChange:u,className:l.address?"error":""}),l.address&&Object(h.jsx)("div",{className:"error-text",children:l.address})]})]}),Object(h.jsxs)("div",{className:"form-section",children:[Object(h.jsx)("h3",{children:"Business Information"}),Object(h.jsxs)("div",{className:"form-row",children:[Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"clientType",children:"Client Type"}),Object(h.jsx)("select",{id:"clientType",name:"clientType",value:n.clientType,onChange:u,children:A.map((e=>Object(h.jsx)("option",{value:e,children:e},e)))})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"panNumber",children:"PAN Number"}),Object(h.jsx)("input",{type:"text",id:"panNumber",name:"panNumber",value:n.panNumber,onChange:u,className:l.panNumber?"error":""}),l.panNumber&&Object(h.jsx)("div",{className:"error-text",children:l.panNumber})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"gstNumber",children:"GST Number"}),Object(h.jsx)("input",{type:"text",id:"gstNumber",name:"gstNumber",value:n.gstNumber,onChange:u,className:l.gstNumber?"error":""}),l.gstNumber&&Object(h.jsx)("div",{className:"error-text",children:l.gstNumber})]})]})]}),Object(h.jsxs)("div",{className:"form-section",children:[Object(h.jsx)("h3",{children:"Services"}),Object(h.jsx)("div",{className:"services-checkboxes",children:P.map((e=>Object(h.jsxs)("div",{className:"checkbox-group",children:[Object(h.jsx)("input",{type:"checkbox",id:`service-${e}`,checked:n.services.includes(e),onChange:()=>(e=>{r((s=>{const t=s.services.includes(e)?s.services.filter((s=>s!==e)):[...s.services,e];return{...s,services:t}}))})(e)}),Object(h.jsx)("label",{htmlFor:`service-${e}`,children:e})]},e)))})]}),Object(h.jsxs)("div",{className:"form-section",children:[Object(h.jsx)("h3",{children:"Additional Information"}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{htmlFor:"notes",children:"Notes"}),Object(h.jsx)("textarea",{id:"notes",name:"notes",value:n.notes,onChange:u,rows:"4"})]})]}),Object(h.jsxs)("div",{className:"form-actions",children:[Object(h.jsx)("button",{type:"button",className:"cancel-button",onClick:c,children:"Cancel"}),Object(h.jsx)("button",{type:"submit",className:"save-button",disabled:o,children:o?"Saving...":b?"Update Client":"Create Client"})]})]})]})};var D={uploadDocument:async(e,s)=>{try{const t=new FormData;t.append("document",s);const a=JSON.parse(localStorage.getItem("user"));return(await N.post(`/clients/${e}/documents`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:a&&a.token?`Bearer ${a.token}`:""}})).data}catch(t){throw console.error("Document upload error:",t.response||t),t}},getDocuments:async e=>{try{if(!e)return console.error("getDocuments: No client ID provided"),[];return(await N.get(`/clients/${e}/documents`)).data}catch(s){throw console.error("Error getting documents:",s.response||s),s}},getDocumentUrl:(e,s)=>`${N.defaults.baseURL}/clients/${e}/documents/${s}`,deleteDocument:async(e,s)=>{try{if(!e||!s)throw console.error("deleteDocument: Missing client ID or document ID"),new Error("Missing required parameters");return(await N.delete(`/clients/${e}/documents/${s}`)).data}catch(t){throw console.error("Error deleting document:",t.response||t),t}}};t(63);var F=e=>{let{clientId:s}=e;const[t,c]=Object(a.useState)([]),[n,r]=Object(a.useState)(!0),[l,i]=Object(a.useState)(!1),[o,d]=Object(a.useState)(null),[j,m]=Object(a.useState)(null);Object(a.useEffect)((()=>{s?b():(console.warn("DocumentManager: No client ID provided"),c([]),r(!1))}),[s]);const b=async()=>{try{r(!0);const e=await D.getDocuments(s);c(e),d(null)}catch(e){console.error("Error fetching documents:",e),d("Failed to load documents. Please try again."),c([])}finally{r(!1)}};return Object(h.jsxs)("div",{className:"document-manager",children:[Object(h.jsxs)("div",{className:"document-upload",children:[Object(h.jsx)("h3",{children:"Upload Document"}),o&&Object(h.jsx)("div",{className:"error-message",children:o}),Object(h.jsxs)("div",{className:"upload-controls",children:[Object(h.jsx)("input",{type:"file",onChange:e=>{e.target.files[0]&&m(e.target.files[0])},className:"file-input",id:"document-upload",disabled:l}),Object(h.jsx)("label",{htmlFor:"document-upload",className:"file-label "+(l?"disabled":""),children:j?j.name:"Choose File"}),Object(h.jsx)("button",{className:"upload-button",onClick:async()=>{if(!j)return void d("Please select a file to upload");if(["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","image/jpeg","image/png"].includes(j.type))if(j.size>10485760)d("File too large. Maximum file size is 10MB.");else try{i(!0),d(null),await D.uploadDocument(s,j),m(null);const e=document.getElementById("document-upload");e&&(e.value=""),await b()}catch(e){console.error("Error uploading document:",e),d("Failed to upload document. Please try again.")}finally{i(!1)}else d("Invalid file type. Only PDF, Word, Excel, and image files are allowed.")},disabled:!j||l,children:l?"Uploading...":"Upload"})]}),Object(h.jsx)("p",{className:"upload-note",children:"Accepted formats: PDF, Word, Excel, and images (up to 10MB)"}),l&&Object(h.jsxs)("div",{className:"upload-progress",children:[Object(h.jsx)("div",{className:"progress-indicator"}),Object(h.jsx)("p",{children:"Uploading document, please wait..."})]})]}),Object(h.jsxs)("div",{className:"document-list",children:[Object(h.jsx)("h3",{children:"Client Documents"}),n?Object(h.jsx)("div",{className:"loading-indicator",children:"Loading documents..."}):0===t.length?Object(h.jsx)("p",{className:"no-documents",children:"No documents uploaded yet"}):Object(h.jsx)("div",{className:"documents-table-container",children:Object(h.jsxs)("table",{className:"documents-table",children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Name"}),Object(h.jsx)("th",{children:"Type"}),Object(h.jsx)("th",{children:"Size"}),Object(h.jsx)("th",{children:"Uploaded"}),Object(h.jsx)("th",{children:"Actions"})]})}),Object(h.jsx)("tbody",{children:t.map((e=>{return Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{className:"document-name",children:[Object(h.jsx)("span",{className:"file-icon",children:(n=e.type,n.includes("pdf")?"\ud83d\udcc4":n.includes("word")?"\ud83d\udcdd":n.includes("excel")||n.includes("spreadsheet")?"\ud83d\udcca":n.includes("image")?"\ud83d\uddbc\ufe0f":"\ud83d\udcce")}),e.name]}),Object(h.jsx)("td",{children:e.type.split("/")[1].toUpperCase()}),Object(h.jsx)("td",{children:(a=e.size,a<1024?a+" bytes":a<1048576?(a/1024).toFixed(1)+" KB":(a/1048576).toFixed(1)+" MB")}),Object(h.jsx)("td",{children:(t=e.uploadedAt,new Date(t).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}))}),Object(h.jsxs)("td",{className:"document-actions",children:[Object(h.jsx)("a",{href:D.getDocumentUrl(s,e._id),target:"_blank",rel:"noopener noreferrer",className:"action-button view-button",children:"View"}),Object(h.jsx)("button",{className:"action-button delete-button",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this document?"))try{d(null),await D.deleteDocument(s,e),c((s=>s.filter((s=>s._id!==e))))}catch(t){console.error("Error deleting document:",t),d("Failed to delete document. Please try again."),b()}})(e._id),children:"Delete"})]})]},e._id);var t,a,n}))})]})})]})]})};t(64);var U=e=>{let{client:s,onEdit:t,onBack:a}=e;if(!s)return Object(h.jsx)("div",{className:"client-detail-loading",children:"Loading client details..."});return Object(h.jsxs)("div",{className:"client-detail-container",children:[Object(h.jsxs)("div",{className:"client-detail-header",children:[Object(h.jsx)("button",{className:"back-button",onClick:a,children:"\u2190 Back to Clients"}),Object(h.jsx)("button",{className:"edit-button",onClick:()=>t(s),children:"Edit Client"})]}),Object(h.jsxs)("div",{className:"client-detail-card",children:[Object(h.jsxs)("div",{className:"client-detail-primary",children:[Object(h.jsx)("h1",{className:"client-name",children:s.name}),Object(h.jsx)("span",{className:"client-type",children:s.clientType})]}),Object(h.jsxs)("div",{className:"client-detail-grid",children:[Object(h.jsxs)("div",{className:"detail-section",children:[Object(h.jsx)("h3",{children:"Contact Information"}),Object(h.jsxs)("div",{className:"detail-item",children:[Object(h.jsx)("span",{className:"detail-label",children:"Email:"}),Object(h.jsx)("span",{className:"detail-value",children:Object(h.jsx)("a",{href:`mailto:${s.email}`,children:s.email})})]}),Object(h.jsxs)("div",{className:"detail-item",children:[Object(h.jsx)("span",{className:"detail-label",children:"Phone:"}),Object(h.jsx)("span",{className:"detail-value",children:Object(h.jsx)("a",{href:`tel:${s.phone}`,children:s.phone})})]}),Object(h.jsxs)("div",{className:"detail-item",children:[Object(h.jsx)("span",{className:"detail-label",children:"Address:"}),Object(h.jsx)("span",{className:"detail-value",children:s.address})]})]}),Object(h.jsxs)("div",{className:"detail-section",children:[Object(h.jsx)("h3",{children:"Business Information"}),s.panNumber&&Object(h.jsxs)("div",{className:"detail-item",children:[Object(h.jsx)("span",{className:"detail-label",children:"PAN Number:"}),Object(h.jsx)("span",{className:"detail-value",children:s.panNumber})]}),s.gstNumber&&Object(h.jsxs)("div",{className:"detail-item",children:[Object(h.jsx)("span",{className:"detail-label",children:"GST Number:"}),Object(h.jsx)("span",{className:"detail-value",children:s.gstNumber})]}),Object(h.jsxs)("div",{className:"detail-item",children:[Object(h.jsx)("span",{className:"detail-label",children:"Created:"}),Object(h.jsx)("span",{className:"detail-value",children:(c=s.createdAt,new Date(c).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}))})]})]})]}),s.services&&s.services.length>0&&Object(h.jsxs)("div",{className:"detail-section",children:[Object(h.jsx)("h3",{children:"Services"}),Object(h.jsx)("div",{className:"services-list",children:s.services.map((e=>Object(h.jsx)("span",{className:"service-tag",children:e},e)))})]}),s.notes&&Object(h.jsxs)("div",{className:"detail-section notes-section",children:[Object(h.jsx)("h3",{children:"Notes"}),Object(h.jsx)("div",{className:"notes-content",children:s.notes})]})]}),s._id?Object(h.jsx)(F,{clientId:s._id}):Object(h.jsx)("div",{className:"document-manager-error",children:Object(h.jsx)("p",{children:"Cannot load document manager - missing client ID."})})]});var c};t(65);const I="list",L="create",T="edit",$="detail";var _=()=>{const[e,s]=Object(a.useState)(I),[t,c]=Object(a.useState)(null),[n,r]=Object(a.useState)(null),l=e=>{c(e),s($)},i=()=>{c(null),s(L)},o=e=>{c(e),s(T)},d=()=>{s(I)},j=e=>{s($),c(e)};return Object(h.jsxs)("div",{className:"client-manager",children:[n&&Object(h.jsxs)("div",{className:"error-notification",children:[n,Object(h.jsx)("button",{onClick:()=>r(null),children:"Dismiss"})]}),(()=>{switch(e){case L:return Object(h.jsx)(k,{onSave:j,onCancel:d});case T:return Object(h.jsx)(k,{client:t,onSave:j,onCancel:d});case $:return Object(h.jsx)(U,{client:t,onEdit:o,onBack:d});default:return Object(h.jsx)(S,{onClientSelect:l,onCreateClient:i})}})()]})};t(66);var B=()=>{const{user:e}=Object(a.useContext)(O);return Object(h.jsxs)("div",{className:"user-dashboard",children:[Object(h.jsxs)("div",{className:"welcome-section",children:[Object(h.jsxs)("h1",{children:["Welcome, ",(null===e||void 0===e?void 0:e.username)||"User"]}),Object(h.jsx)("p",{children:"This is your dashboard for managing client information. Use the client manager below to view, create, edit, and manage your clients."})]}),Object(h.jsx)("div",{className:"dashboard-content",children:Object(h.jsx)(_,{})})]})};var q=e=>{let{component:s,requiredRole:t,...c}=e;const{user:n,loading:r}=Object(a.useContext)(O);return Object(h.jsx)(i.b,{...c,render:e=>r?Object(h.jsx)("div",{className:"loading-screen",children:"Loading..."}):n?t&&n.role!==t?Object(h.jsx)(i.a,{to:"admin"===n.role?"/admin":"/user"}):Object(h.jsx)(s,{...e}):Object(h.jsx)(i.a,{to:{pathname:"/login",state:{from:e.location}}})})};t(67);var M=()=>{const{user:e,logout:s}=Object(a.useContext)(O),t=Object(i.g)();return Object(h.jsxs)("header",{className:"header",children:[Object(h.jsx)("div",{className:"logo",children:Object(h.jsx)("h1",{children:"CA Client Manager"})}),e&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("nav",{className:"navigation",children:Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(l.b,{to:"admin"===e.role?"/admin":"/user",children:"Dashboard"})}),Object(h.jsx)("li",{children:Object(h.jsx)(l.b,{to:"/clients",children:"Clients"})}),"admin"===e.role&&Object(h.jsx)("li",{children:Object(h.jsx)(l.b,{to:"/users",children:"Users"})})]})}),Object(h.jsxs)("div",{className:"user-menu",children:[Object(h.jsxs)("div",{className:"user-info",children:["Welcome, ",e.username," (",e.role,")"]}),Object(h.jsx)("button",{className:"logout-button",onClick:async()=>{await s(),t.push("/login")},children:"Logout"})]})]})]})};t(68);var V=()=>{const[e,s]=Object(a.useState)(!1),{user:t}=Object(a.useContext)(O);return Object(h.jsxs)("div",{className:"sidebar "+(e?"sidebar-collapsed":""),children:[Object(h.jsxs)("div",{className:"sidebar-header",children:[Object(h.jsx)("h2",{children:!e&&"Navigation"}),Object(h.jsx)("button",{className:"collapse-button",onClick:()=>{s(!e)},children:e?"\u2192":"\u2190"})]}),Object(h.jsxs)("ul",{className:"sidebar-menu",children:[Object(h.jsx)("li",{className:"sidebar-category",children:"Main"}),Object(h.jsx)("li",{className:"sidebar-item",children:Object(h.jsxs)(l.c,{to:"admin"===(null===t||void 0===t?void 0:t.role)?"/admin":"/user",className:"sidebar-link",activeClassName:"active",children:[Object(h.jsx)("span",{className:"sidebar-icon",children:"\ud83d\udcca"}),Object(h.jsx)("span",{className:"sidebar-text",children:"Dashboard"})]})}),Object(h.jsx)("li",{className:"sidebar-category",children:"Management"}),Object(h.jsx)("li",{className:"sidebar-item",children:Object(h.jsxs)(l.c,{to:"/clients",className:"sidebar-link",activeClassName:"active",children:[Object(h.jsx)("span",{className:"sidebar-icon",children:"\ud83d\udc65"}),Object(h.jsx)("span",{className:"sidebar-text",children:"Clients"})]})}),"admin"===(null===t||void 0===t?void 0:t.role)&&Object(h.jsx)("li",{className:"sidebar-item",children:Object(h.jsxs)(l.c,{to:"/users",className:"sidebar-link",activeClassName:"active",children:[Object(h.jsx)("span",{className:"sidebar-icon",children:"\ud83d\udc64"}),Object(h.jsx)("span",{className:"sidebar-text",children:"Users"})]})}),Object(h.jsx)("li",{className:"sidebar-category",children:"System"}),Object(h.jsx)("li",{className:"sidebar-item",children:Object(h.jsxs)(l.c,{to:"/settings",className:"sidebar-link",activeClassName:"active",children:[Object(h.jsx)("span",{className:"sidebar-icon",children:"\u2699\ufe0f"}),Object(h.jsx)("span",{className:"sidebar-text",children:"Settings"})]})})]})]})};t(69);var R=()=>Object(h.jsx)("footer",{className:"footer",children:Object(h.jsxs)("div",{className:"footer-content",children:[Object(h.jsxs)("p",{children:["\xa9 ",(new Date).getFullYear()," CA Client Manager by KlickBurn. All rights reserved."]}),Object(h.jsx)("p",{children:"A beautiful and classy client management solution"})]})});t(25),t(70);var Z=function(){return Object(h.jsx)(x,{children:Object(h.jsx)(l.a,{children:Object(h.jsx)("div",{className:"app-container",children:Object(h.jsxs)(i.d,{children:[Object(h.jsx)(i.b,{path:"/login",component:p}),Object(h.jsx)(i.b,{path:"/",exact:!0,children:Object(h.jsx)(i.a,{to:"/login"})}),Object(h.jsx)(i.b,{path:"/(admin|user)",children:Object(h.jsxs)("div",{className:"authenticated-container",children:[Object(h.jsx)(M,{}),Object(h.jsxs)("div",{className:"content-container",children:[Object(h.jsx)(V,{}),Object(h.jsx)("main",{className:"main-content",children:Object(h.jsxs)(i.d,{children:[Object(h.jsx)(q,{path:"/admin",component:y,requiredRole:"admin"}),Object(h.jsx)(q,{path:"/user",component:B})]})})]}),Object(h.jsx)(R,{})]})})]})})})})};r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(x,{children:Object(h.jsx)(Z,{})})}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.bd93f2dc.chunk.js.map