{"ast":null,"code":"import React,{useState,useEffect}from'react';import'./UserForm.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const initialFormState={username:'',password:'',role:'user'};const UserForm=_ref=>{let{user,onSave,onCancel}=_ref;const[formData,setFormData]=useState(initialFormState);const[errors,setErrors]=useState({});const[loading,setLoading]=useState(false);const[submitError,setSubmitError]=useState(null);const isEditMode=!!(user!==null&&user!==void 0&&user._id);useEffect(()=>{if(user){setFormData({username:user.username||'',password:'',// Don't fill password field for security\nrole:user.role||'user'});}},[user]);const handleChange=e=>{const{name,value}=e.target;setFormData(prev=>({...prev,[name]:value}));// Clear error when field is updated\nif(errors[name]){setErrors(prev=>({...prev,[name]:null}));}};const validateForm=()=>{const newErrors={};if(!formData.username.trim()){newErrors.username='Username is required';}else if(formData.username.trim().length<3){newErrors.username='Username must be at least 3 characters';}if(!isEditMode&&!formData.password.trim()){newErrors.password='Password is required';}else if(!isEditMode&&formData.password.trim().length<6){newErrors.password='Password must be at least 6 characters';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm())return;setLoading(true);setSubmitError(null);try{// Only include password in payload if it's provided\nconst userData={username:formData.username,role:formData.role};if(formData.password.trim()){userData.password=formData.password;}await onSave(userData,isEditMode);}catch(error){var _error$response,_error$response$data;console.error('Error saving user:',error);setSubmitError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Error saving user. Please try again.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"user-form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:isEditMode?'Edit User':'Create New User'}),submitError&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:submitError}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"user-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",name:\"username\",value:formData.username,onChange:handleChange,className:errors.username?'error':''}),errors.username&&/*#__PURE__*/_jsx(\"div\",{className:\"error-text\",children:errors.username})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:isEditMode?'New Password (leave blank to keep current)':'Password'}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",value:formData.password,onChange:handleChange,className:errors.password?'error':''}),errors.password&&/*#__PURE__*/_jsx(\"div\",{className:\"error-text\",children:errors.password})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"role\",children:\"Role\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"role\",name:\"role\",value:formData.role,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:\"User\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"cancel-button\",onClick:onCancel,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"save-button\",disabled:loading,children:loading?'Saving...':isEditMode?'Update User':'Create User'})]})]})]});};export default UserForm;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","initialFormState","username","password","role","UserForm","_ref","user","onSave","onCancel","formData","setFormData","errors","setErrors","loading","setLoading","submitError","setSubmitError","isEditMode","_id","handleChange","e","name","value","target","prev","validateForm","newErrors","trim","length","Object","keys","handleSubmit","preventDefault","userData","error","_error$response","_error$response$data","console","response","data","message","className","children","onSubmit","htmlFor","type","id","onChange","onClick","disabled"],"sources":["/Users/klickburn/Projects/client-db/ca-client-management/frontend/src/components/User/UserForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './UserForm.css';\n\nconst initialFormState = {\n    username: '',\n    password: '',\n    role: 'user'\n};\n\nconst UserForm = ({ user, onSave, onCancel }) => {\n    const [formData, setFormData] = useState(initialFormState);\n    const [errors, setErrors] = useState({});\n    const [loading, setLoading] = useState(false);\n    const [submitError, setSubmitError] = useState(null);\n    const isEditMode = !!user?._id;\n\n    useEffect(() => {\n        if (user) {\n            setFormData({\n                username: user.username || '',\n                password: '',  // Don't fill password field for security\n                role: user.role || 'user'\n            });\n        }\n    }, [user]);\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({ ...prev, [name]: value }));\n        \n        // Clear error when field is updated\n        if (errors[name]) {\n            setErrors(prev => ({ ...prev, [name]: null }));\n        }\n    };\n\n    const validateForm = () => {\n        const newErrors = {};\n        \n        if (!formData.username.trim()) {\n            newErrors.username = 'Username is required';\n        } else if (formData.username.trim().length < 3) {\n            newErrors.username = 'Username must be at least 3 characters';\n        }\n        \n        if (!isEditMode && !formData.password.trim()) {\n            newErrors.password = 'Password is required';\n        } else if (!isEditMode && formData.password.trim().length < 6) {\n            newErrors.password = 'Password must be at least 6 characters';\n        }\n        \n        setErrors(newErrors);\n        return Object.keys(newErrors).length === 0;\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        \n        if (!validateForm()) return;\n        \n        setLoading(true);\n        setSubmitError(null);\n        \n        try {\n            // Only include password in payload if it's provided\n            const userData = {\n                username: formData.username,\n                role: formData.role\n            };\n            \n            if (formData.password.trim()) {\n                userData.password = formData.password;\n            }\n            \n            await onSave(userData, isEditMode);\n        } catch (error) {\n            console.error('Error saving user:', error);\n            setSubmitError(\n                error.response?.data?.message || \n                'Error saving user. Please try again.'\n            );\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"user-form-container\">\n            <h2>{isEditMode ? 'Edit User' : 'Create New User'}</h2>\n            \n            {submitError && (\n                <div className=\"error-message\">{submitError}</div>\n            )}\n            \n            <form onSubmit={handleSubmit} className=\"user-form\">\n                <div className=\"form-group\">\n                    <label htmlFor=\"username\">Username</label>\n                    <input\n                        type=\"text\"\n                        id=\"username\"\n                        name=\"username\"\n                        value={formData.username}\n                        onChange={handleChange}\n                        className={errors.username ? 'error' : ''}\n                    />\n                    {errors.username && <div className=\"error-text\">{errors.username}</div>}\n                </div>\n                \n                <div className=\"form-group\">\n                    <label htmlFor=\"password\">\n                        {isEditMode ? 'New Password (leave blank to keep current)' : 'Password'}\n                    </label>\n                    <input\n                        type=\"password\"\n                        id=\"password\"\n                        name=\"password\"\n                        value={formData.password}\n                        onChange={handleChange}\n                        className={errors.password ? 'error' : ''}\n                    />\n                    {errors.password && <div className=\"error-text\">{errors.password}</div>}\n                </div>\n                \n                <div className=\"form-group\">\n                    <label htmlFor=\"role\">Role</label>\n                    <select\n                        id=\"role\"\n                        name=\"role\"\n                        value={formData.role}\n                        onChange={handleChange}\n                    >\n                        <option value=\"user\">User</option>\n                        <option value=\"admin\">Admin</option>\n                    </select>\n                </div>\n                \n                <div className=\"form-actions\">\n                    <button \n                        type=\"button\" \n                        className=\"cancel-button\"\n                        onClick={onCancel}\n                    >\n                        Cancel\n                    </button>\n                    <button \n                        type=\"submit\" \n                        className=\"save-button\"\n                        disabled={loading}\n                    >\n                        {loading ? 'Saving...' : isEditMode ? 'Update User' : 'Create User'}\n                    </button>\n                </div>\n            </form>\n        </div>\n    );\n};\n\nexport default UserForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}