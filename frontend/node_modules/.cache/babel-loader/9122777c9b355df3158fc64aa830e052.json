{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import{authService}from'../services/authService';import{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchUser=async()=>{try{const currentUser=await authService.getCurrentUser();setUser(currentUser);}catch(error){console.error(\"Failed to fetch user:\",error);// Clear the invalid user data if there's an error\nlocalStorage.removeItem('user');setUser(null);}finally{setLoading(false);}};fetchUser();},[]);const login=async(username,password)=>{try{const loggedInUser=await authService.login(username,password);setUser(loggedInUser);return loggedInUser;}catch(error){console.error(\"Login failed:\",error);throw error;}};const logout=async()=>{await authService.logout();setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,loading,login,logout},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","authService","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","fetchUser","currentUser","getCurrentUser","error","console","localStorage","removeItem","login","username","password","loggedInUser","logout","Provider","value"],"sources":["/Users/klickburn/Projects/client-db/ca-client-management/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport { authService } from '../services/authService';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const fetchUser = async () => {\n            try {\n                const currentUser = await authService.getCurrentUser();\n                setUser(currentUser);\n            } catch (error) {\n                console.error(\"Failed to fetch user:\", error);\n                // Clear the invalid user data if there's an error\n                localStorage.removeItem('user');\n                setUser(null);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchUser();\n    }, []);\n\n    const login = async (username, password) => {\n        try {\n            const loggedInUser = await authService.login(username, password);\n            setUser(loggedInUser);\n            return loggedInUser;\n        } catch (error) {\n            console.error(\"Login failed:\", error);\n            throw error;\n        }\n    };\n\n    const logout = async () => {\n        await authService.logout();\n        setUser(null);\n    };\n\n    return (\n        <AuthContext.Provider value={{ user, loading, login, logout }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACjE,OAASC,WAAW,KAAQ,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEtD,MAAO,MAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,CAAC,CAE1C,MAAO,MAAM,CAAAO,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACrC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACW,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CAE5CC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAY,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1B,GAAI,CACA,KAAM,CAAAC,WAAW,CAAG,KAAM,CAAAZ,WAAW,CAACa,cAAc,CAAC,CAAC,CACtDL,OAAO,CAACI,WAAW,CAAC,CACxB,CAAE,MAAOE,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7C;AACAE,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC,CAC/BT,OAAO,CAAC,IAAI,CAAC,CACjB,CAAC,OAAS,CACNE,UAAU,CAAC,KAAK,CAAC,CACrB,CACJ,CAAC,CAEDC,SAAS,CAAC,CAAC,CACf,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAO,KAAK,CAAG,KAAAA,CAAOC,QAAQ,CAAEC,QAAQ,GAAK,CACxC,GAAI,CACA,KAAM,CAAAC,YAAY,CAAG,KAAM,CAAArB,WAAW,CAACkB,KAAK,CAACC,QAAQ,CAAEC,QAAQ,CAAC,CAChEZ,OAAO,CAACa,YAAY,CAAC,CACrB,MAAO,CAAAA,YAAY,CACvB,CAAE,MAAOP,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,eAAe,CAAEA,KAAK,CAAC,CACrC,KAAM,CAAAA,KAAK,CACf,CACJ,CAAC,CAED,KAAM,CAAAQ,MAAM,CAAG,KAAAA,CAAA,GAAY,CACvB,KAAM,CAAAtB,WAAW,CAACsB,MAAM,CAAC,CAAC,CAC1Bd,OAAO,CAAC,IAAI,CAAC,CACjB,CAAC,CAED,mBACIN,IAAA,CAACC,WAAW,CAACoB,QAAQ,EAACC,KAAK,CAAE,CAAEjB,IAAI,CAAEE,OAAO,CAAES,KAAK,CAAEI,MAAO,CAAE,CAAAhB,QAAA,CACzDA,QAAQ,CACS,CAAC,CAE/B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}